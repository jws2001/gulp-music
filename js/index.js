!function(n,s){function t(t){this.warp=t,this.dataList=[],this.indexObj=null,this.rotateTimer=null,this.curIndex=0,this.list=null}t.prototype={init:function(){this.getDom(),this.getData("../mock/data.json")},getDom:function(){this.record=document.querySelector(".songImg img"),this.controlBtns=document.querySelectorAll(".control li")},getData:function(t){var i=this;n.ajax({url:t,methods:"get",success:function(t){i.dataList=t,i.listPlay(),i.indexObj=new s.controlIndex(t.length),i.loadMuice(i.indexObj.index),i.musicControl(),i.drop()},error:function(){}})},loadMuice:function(t){s.render(this.dataList[t]),s.music.load(this.dataList[t].audioSrc),s.pro.renderAllTime(this.dataList[t].duration),"play"===s.music.status&&(s.music.play(),this.controlBtns[2].className="play"===s.music.status?"playing":"",this.imgRotate(0)),this.list.changeSelect(t),this.curIndex=t},musicControl:function(){var i=this;this.controlBtns[1].addEventListener("touchend",function(){s.music.status="play",i.loadMuice(i.indexObj.prev()),s.pro.start(0)}),this.controlBtns[2].addEventListener("touchend",function(){var t;"play"===s.music.status?(s.music.pause(),this.className="",i.imgStop(),s.pro.stop()):(s.music.play(),s.pro.start(),this.className="playing",t=i.record.dataset.rotate,i.imgRotate(t))}),this.controlBtns[3].ontouchend=function(){s.music.status="play",i.loadMuice(i.indexObj.next()),s.pro.start(0)}},imgRotate:function(t){t=t||0,clearInterval(this.rotateTimer);var i=this;this.rotateTimer=setInterval(function(){t=+t+.2,i.record.style.transform="rotate("+t+"deg)",i.record.dataset.rotate=t},1e3/60)},imgStop:function(){clearInterval(this.rotateTimer)},listPlay:function(){var n=this;this.list=s.listControl(this.dataList,this.warp),this.controlBtns[4].addEventListener("touchend",function(){n.list.slideUp()}),this.list.musicList.forEach(function(t,i){t.addEventListener("touchend",function(){n.curIndex!==i&&(s.music.status="play",n.indexObj.index=i,n.loadMuice(i),n.list.slideDown())})})},drop:function(){s.drop(this.dataList[this.curIndex].duration,this.warp.children[3].children[2])}},s.musicPlayer=new t(document.getElementById("warp")),s.musicPlayer.init()}(window.Zepto,window.player||(window.player={}));